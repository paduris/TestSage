# TestSage Box Diagrams

## System Overview
```
┌─────────────────────────────────────────────────────────────────┐
│                      TestSage System                            │
│                                                                 │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐     │
│  │   Frontend   │    │   Backend    │    │  Database    │     │
│  │  (React.js)  │◄──►│(Spring Boot) │◄──►│ (PostgreSQL) │     │
│  └──────────────┘    └──────────────┘    └──────────────┘     │
│          ▲                   ▲                   ▲             │
│          │                   │                   │             │
│          ▼                   ▼                   ▼             │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐     │
│  │    Cache     │    │  OpenAI API  │    │     Git      │     │
│  │   (Redis)    │    │             │    │ Repositories │     │
│  └──────────────┘    └──────────────┘    └──────────────┘     │
└─────────────────────────────────────────────────────────────────┘
```

## Frontend Architecture
```
┌─────────────────────────────────────────────────────────────┐
│                    Frontend Components                       │
│                                                             │
│  ┌────────────────────┐        ┌────────────────────┐      │
│  │    Components      │        │      Services      │      │
│  │ ┌──────────────┐  │        │ ┌──────────────┐   │      │
│  │ │  Repository  │  │        │ │    API       │   │      │
│  │ └──────────────┘  │        │ └──────────────┘   │      │
│  │ ┌──────────────┐  │        │ ┌──────────────┐   │      │
│  │ │   Analysis   │  │◄─────┐ │ │    Auth      │   │      │
│  │ └──────────────┘  │      │ │ └──────────────┘   │      │
│  │ ┌──────────────┐  │      └─│─┌──────────────┐   │      │
│  │ │    Tests     │  │        │ │    State     │   │      │
│  │ └──────────────┘  │        │ └──────────────┘   │      │
│  └────────────────────┘        └────────────────────┘      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## Backend Architecture
```
┌────────────────────────────────────────────────────────────┐
│                    Backend Components                       │
│                                                            │
│  ┌───────────────┐    ┌───────────────┐   ┌───────────┐   │
│  │  Controllers  │    │   Services    │   │Repository │   │
│  │ ┌─────────┐  │    │ ┌─────────┐   │   │ ┌─────┐   │   │
│  │ │Analysis │──┼────┼─►Analysis │───┼───┼─►Data │   │   │
│  │ └─────────┘  │    │ └─────────┘   │   │ └─────┘   │   │
│  │ ┌─────────┐  │    │ ┌─────────┐   │   │ ┌─────┐   │   │
│  │ │  Test   │──┼────┼─►  Test   │───┼───┼─►Data │   │   │
│  │ └─────────┘  │    │ └─────────┘   │   │ └─────┘   │   │
│  │ ┌─────────┐  │    │ ┌─────────┐   │   │ ┌─────┐   │   │
│  │ │  Risk   │──┼────┼─►  Risk   │───┼───┼─►Data │   │   │
│  │ └─────────┘  │    │ └─────────┘   │   │ └─────┘   │   │
│  └───────────────┘    └───────────────┘   └───────────┘   │
└────────────────────────────────────────────────────────────┘
```

## Database Schema
```
┌────────────────────────────────────────────────────────┐
│                   Database Schema                       │
│                                                        │
│  ┌─────────────────┐       ┌────────────────┐         │
│  │   Repository    │       │    Analysis    │         │
│  │ ┌─────────────┐ │       │┌────────────┐  │         │
│  │ │id           │ │       ││id          │  │         │
│  │ │name         │ │       ││repository_id│  │         │
│  │ │git_url      │◄├───────┤│status      │  │         │
│  │ │branch       │ │       ││results     │  │         │
│  │ │domain       │ │       ││created_at  │  │         │
│  │ └─────────────┘ │       │└────────────┘  │         │
│  └─────────────────┘       └────────────────┘         │
│                                                        │
│  ┌─────────────────┐       ┌────────────────┐         │
│  │   RiskConfig    │       │     Tests      │         │
│  │ ┌─────────────┐ │       │┌────────────┐  │         │
│  │ │id           │ │       ││id          │  │         │
│  │ │pattern      │ │       ││analysis_id │  │         │
│  │ │weight       │ │       ││content     │  │         │
│  │ │description  │ │       ││type        │  │         │
│  │ └─────────────┘ │       │└────────────┘  │         │
│  └─────────────────┘       └────────────────┘         │
└────────────────────────────────────────────────────────┘
```

## Deployment Architecture
```
┌──────────────────────────────────────────────────────────┐
│                 Production Environment                    │
│                                                          │
│  ┌────────────────┐                                      │
│  │ Load Balancer  │                                      │
│  │    (NGINX)     │                                      │
│  └────────────────┘                                      │
│          │                                               │
│  ┌───────┴──────────────────────────────┐               │
│  │        Kubernetes Cluster            │               │
│  │                                      │               │
│  │  ┌──────────┐      ┌──────────┐     │               │
│  │  │Frontend  │      │Backend   │     │               │
│  │  │Pods      │      │Pods      │     │               │
│  │  │┌──────┐  │      │┌──────┐  │     │               │
│  │  ││Pod 1 │  │      ││Pod 1 │  │     │               │
│  │  │└──────┘  │      │└──────┘  │     │               │
│  │  │┌──────┐  │      │┌──────┐  │     │               │
│  │  ││Pod 2 │  │      ││Pod 2 │  │     │               │
│  │  │└──────┘  │      │└──────┘  │     │               │
│  │  └──────────┘      └──────────┘     │               │
│  │                                      │               │
│  │  ┌──────────┐      ┌──────────┐     │               │
│  │  │Database  │      │ Cache    │     │               │
│  │  │┌──────┐  │      │┌──────┐  │     │               │
│  │  ││Master│  │      ││Redis │  │     │               │
│  │  │└──────┘  │      │└──────┘  │     │               │
│  │  │┌──────┐  │      │┌──────┐  │     │               │
│  │  ││Slave │  │      ││Slave │  │     │               │
│  │  │└──────┘  │      │└──────┘  │     │               │
│  │  └──────────┘      └──────────┘     │               │
│  └──────────────────────────────────────┘               │
│                                                          │
│  ┌──────────────────────────────────────┐               │
│  │           Monitoring                 │               │
│  │  ┌──────────┐  ┌──────────┐         │               │
│  │  │Prometheus│  │ Grafana  │         │               │
│  │  └──────────┘  └──────────┘         │               │
│  └──────────────────────────────────────┘               │
└──────────────────────────────────────────────────────────┘
```

## Test Generation Flow
```
┌────────────────────────────────────────────────────────┐
│                 Test Generation Process                 │
│                                                        │
│  ┌──────────────┐    ┌───────────────┐   ┌─────────┐  │
│  │ Code Changes │───►│Risk Analysis  │──►│OpenAI   │  │
│  └──────────────┘    └───────────────┘   └─────────┘  │
│          │                                     │       │
│          ▼                                     ▼       │
│  ┌──────────────┐    ┌───────────────┐   ┌─────────┐  │
│  │ Risk Patterns│    │Test Templates │   │Generated│  │
│  │              │───►│               │──►│Tests    │  │
│  └──────────────┘    └───────────────┘   └─────────┘  │
│                                                        │
└────────────────────────────────────────────────────────┘
```

## CI/CD Pipeline
```
┌────────────────────────────────────────────────────────┐
│                    CI/CD Pipeline                      │
│                                                        │
│  ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌───────┐  │
│  │  Code   │   │  Build  │   │  Test   │   │Deploy │  │
│  │  Push   │──►│         │──►│         │──►│       │  │
│  └─────────┘   └─────────┘   └─────────┘   └───────┘  │
│       │             │             │            │       │
│       ▼             ▼             ▼            ▼       │
│  ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌───────┐  │
│  │  Lint   │   │Security │   │ Docker  │   │Release│  │
│  │  Check  │   │  Scan   │   │ Build   │   │       │  │
│  └─────────┘   └─────────┘   └─────────┘   └───────┘  │
└────────────────────────────────────────────────────────┘
```
